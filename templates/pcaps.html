<html>


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/navbars/">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pcaps.css') }}">
    
</head>

<body>


	<div class="container" id='container'>
		<nav class="navbar navbar-expand-lg rounded" aria-label="Eleventh navbar example">
		  <div class="container-fluid">
			<a class="navbar-brand" href="#">Menu</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample09" aria-controls="navbarsExample09" aria-expanded="false" aria-label="Toggle navigation">
			  <span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarsExample09">
			  <ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<li class="nav-item active">
				  <a class="nav-link" aria-current="page" href="/">Home</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/alerts">Alerts</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/preview_whitelist">Whitelist</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/previewBlacklist">Blacklist</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/previewRules" tabindex="-1">Rules</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/pcapAnalysis">PCAPs</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/register" tabindex="-1">Register</a>
				</li>
			  </ul>
			</div>
		  </div>
		</nav>
	</div>
	

	<div class='modal' id='modal'>
	</div>


	
	<div class="content">
		
	<div ondragover=alert(1) class="thirdbox" id="third">
				
		<form action="/action_page.php">
			<input type="file" id="myFile" name="filename">
			<input type="submit">
		</form>
		
	</div>

	
		
	</div>



</body>


	<script>
		//https://blog.filestack.com/thoughts-and-knowledge/ajax-file-upload-formdata-examples/
		function supportAjaxUploadWithProgress() {
  			return supportFileAPI() && supportAjaxUploadProgressEvents() && supportFormData();

  		function supportFileAPI() {
		    var fi = document.createElement('INPUT');
		    fi.type = 'file';
		    return 'files' in fi;
		  };

		  function supportAjaxUploadProgressEvents() {
		    var xhr = new XMLHttpRequest();
		    return !! (xhr && ('upload' in xhr) && ('onprogress' in xhr.upload));
		  };

		  function supportFormData() {
		    return !! window.FormData;
		  }
		}

		var form = document.getElementById('alerts_form');
		var fileSelect = document.getElementById('getFile');
		var uploadButton = document.getElementById('uploadGetFile');
		form.onsubmit = function(event) {
		  // Prevent a non-AJAX file upload from starting
		  event.preventDefault();

		  // Let the user know that the upload has begun

		  // Get the selected files from the input
		  var files = fileSelect.files;
		  
		  // Create a new FormData object
		  var formData = new FormData();
		  
		  // Loop through each of the selected files.
		  for(var i = 0; i < files.length; i++){
		    var file = files[i];
		    // Check the file type

		    // Add the file to the form's data
		    formData.append('file', file, file.name);
		  }
		  
		  // Set up the request object
		  var xhr = new XMLHttpRequest();
		  
		  // Open the connection and pass the file name
		  xhr.open('POST', 'loadFile', true);
		  
		  // Set up a handler for when the request finishes
		  xhr.onload = function () {
		    if (xhr.status === 200) {
		    	document.getElementById('third').innerHTML=xhr.responseText;
		      // File(s) uploaded
		    } else {
		      alert('Something went wrong uploading the file.');
		    }
		  };
		  
		  xhr.send(formData);
		}



	</script>


	<script>
		 document.getElementById("forth").style.height =  document.getElementById("third").style.height; 
	</script>

	<script>
	var expanded = false;

	function showCheckboxes() {
		var checkboxes = document.getElementById("checkboxes");
		if (!expanded) {
			checkboxes.style.display = "block";
			expanded = true;
		} else {
			checkboxes.style.display = "none";
			expanded = false;
		}
	}
	</script>



	<script>
		document.getElementById("icmp_progress").style.width = "{{icmp}}";
		document.getElementById("http_progress").style.width = "{{http}}";
		document.getElementById("https_progress").style.width = "{{https}}";
		document.getElementById("dns_progress").style.width = "{{dns}}";
		document.getElementById("conn_progress").style.width = "{{cn}}";
		document.getElementById("listen_progress").style.width = "{{lc}}";
		document.getElementById("anomalies_progress").style.width = "{{anomalies}}";
		document.getElementById("vt_progress").style.width = "{{vt}}";
		document.getElementById("https_progress").style.width = "{{hsc}}";
		document.getElementById("second").style.height = document.getElementById("first").clientHeight;
		document.getElementById("third").style.marginTop  = document.getElementById("second").clientHeight;
	</script>
	
	<script>
		var ok = 0;
		function reveal(id){
			if (ok == 1){
				document.getElementById("edit").style.display = "none";
				document.getElementById("modal").style.display = "none";
				ok = 0
			}
			else if (ok == 0){
				get_edit_details(id);
				document.getElementById("edit").style.display = "block";
				document.getElementById("modal").style.display = "block";
				ok = 1
			}
		}
	</script>


	<script>
		function hide(){
				document.getElementById("edit").style.display = "none";
				document.getElementById("modal").style.display = "none";
			ok = 0;
		}
	</script>



	<script>
	function get_edit_details(id) {
		var nume="button_id=";
		var name=id;
		nume = nume.concat(name);
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				var response = this.responseText;
				document.getElementById("edit_left").innerHTML = response.split("|")[0];
				document.getElementById("edit_right").innerHTML = response.split("|")[1];
			}
		};
		xhttp.open("POST", "/update_edit", true);
		xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		xhttp.send(nume);
	}
	</script>




	<script>
	function post_edit_details_destination(id) {
		var nume="button_id=";
		var name=id;
		nume = nume.concat(name);
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				var response = this.responseText;
				alert(response);
			}
		};
		xhttp.open("POST", "/edit_destionation", true);
		xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		xhttp.send(nume);
	}
	</script>



	<script>
	function post_edit_details_payload(id) {
		var nume="button_id=";
		var name=id;
		nume = nume.concat(name);
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				var response = this.responseText;
				alert(response);
			}
		};
		xhttp.open("POST", "/edit_payload", true);
		xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		xhttp.send(nume);
	}
	</script>


    <script src="js/bootstrap.bundle.min.js"></script>


    <script>
    	function showFilters(){
    		document.getElementById('first').style.display="block";
    		document.getElementById('little_first_box').style.display="none";
    	}	
    	function hide2(){
    		document.getElementById('first').style.display="none";
    		document.getElementById('little_first_box').style.display="block";
    	}	


	</script>

	<script>
		function exportData(){
			var forLogs="";
			var oTable = document.getElementById('tabel_alerte');

			var rowLength = oTable.rows.length;
			for (let i = 0; i < rowLength; i++){

				var oCells = oTable.rows.item(i).cells;

				var cellLength = oCells.length;

				for(var j = 0; j < cellLength; j++){
					var cellVal = oCells.item(j).innerHTML; 
					var n = cellVal.includes("<button");
					if (n == false){
						if ((i == 0) && (j == cellLength - 1)){
							forLogs=forLogs.concat(cellVal);
						}
						else{
							forLogs=forLogs.concat(cellVal);
							forLogs=forLogs.concat("\t");
						}
					}
					else{
						forLogs=forLogs.concat(":)");
					}
				}
				forLogs=forLogs.concat("\n");
			}
			an = new Date().getDate();
			luna = new Date().getMonth();
			zi = new Date().getFullYear();
			timestamp = new Date().getTime();
			name=zi+"/"+luna+"/"+an+"-"+timestamp+".txt";
			var bb = new Blob([forLogs ], { type: 'text/plain' });
			var a = document.createElement('a');
			a.download = name;
			a.href = window.URL.createObjectURL(bb);
			a.click();
		}
	</script>



<script>
	function dragStart(event) {
		event.dataTransfer.setData("Text", event.target.id);
	}

	function allowDrop(event) {
		event.preventDefault();
	}

	function drop(event) {
		event.preventDefault();
		var data = event.dataTransfer.getData("Text");
		event.target.appendChild(document.getElementById(data));
	}
</script>

<script>

	function checkValues(){
		var x = document.getElementById('forth_left').innerHTML;
		var z = x.split("<");
		var forReturn = "";
		for(let i=1; i<z.length; i++){
			z[i] = z[i].split(",");
			for(let j=0; j<z[i].length; j++){
				var n = z[i][j].includes("dragtarget");
				if (n == true){
					var type = z[i][j].split(">")[1];
					forReturn = forReturn.concat(type+", ");
				}
			}
		}
		document.getElementById('hiddenID').value=forReturn;
	}


</script>


<script>
	function discover(){
		document.getElementById('forthbox_after').style.display='block';
		document.getElementById('forthbox_before').style.display='none';
		document.getElementById('forth').style.paddingTop = "0px"; 
	}

	function question(){
		document.getElementById('forthbox_after').style.display='none';
		document.getElementById('forthbox_before').style.display='block';
		document.getElementById('forth').style.paddingTop = "20px"; 
	}
</script>
</html>